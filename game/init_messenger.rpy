
define cg_screen_messenger_recv_len0 = im.FactorScale("CG_messenger_desktop/msg_received_len0.png", SCALE)
define cg_screen_messenger_recv_len1 = im.FactorScale("CG_messenger_desktop/msg_received_len1.png", SCALE)
define cg_screen_messenger_recv_len2 = im.FactorScale("CG_messenger_desktop/msg_received_len2.png", SCALE)
define cg_screen_messenger_recv_len3 = im.FactorScale("CG_messenger_desktop/msg_received_len3.png", SCALE)
define cg_screen_messenger_recv_len4 = im.FactorScale("CG_messenger_desktop/msg_received_len4.png", SCALE)
define cg_screen_messenger_recv_len5_1 = im.FactorScale("CG_messenger_desktop/msg_received_len5_1.png", SCALE)
define cg_screen_messenger_recv_len5_2 = im.FactorScale("CG_messenger_desktop/msg_received_len5_2.png", SCALE)
define cg_screen_messenger_recv_len5_3 = im.FactorScale("CG_messenger_desktop/msg_received_len5_3.png", SCALE)
define cg_screen_messenger_recv_len5_4 = im.FactorScale("CG_messenger_desktop/msg_received_len5_4.png", SCALE)
define cg_screen_messenger_recv_len5_5 = im.FactorScale("CG_messenger_desktop/msg_received_len5_5.png", SCALE)
define cg_screen_messenger_recv_len5_6 = im.FactorScale("CG_messenger_desktop/msg_received_len5_6.png", SCALE)


define cg_screen_messenger_sent_len0 = im.FactorScale("CG_messenger_desktop/msg_sent_len0.png", SCALE)
define cg_screen_messenger_sent_len1 = im.FactorScale("CG_messenger_desktop/msg_sent_len1.png", SCALE)
define cg_screen_messenger_sent_len2 = im.FactorScale("CG_messenger_desktop/msg_sent_len2.png", SCALE)
define cg_screen_messenger_sent_len3 = im.FactorScale("CG_messenger_desktop/msg_sent_len3.png", SCALE)
define cg_screen_messenger_sent_len4 = im.FactorScale("CG_messenger_desktop/msg_sent_len4.png", SCALE)
define cg_screen_messenger_sent_len5_1 = im.FactorScale("CG_messenger_desktop/msg_sent_len5_1.png", SCALE)
define cg_screen_messenger_sent_len5_2 = im.FactorScale("CG_messenger_desktop/msg_sent_len5_2.png", SCALE)
define cg_screen_messenger_sent_len5_3 = im.FactorScale("CG_messenger_desktop/msg_sent_len5_3.png", SCALE)
define cg_screen_messenger_sent_len5_4 = im.FactorScale("CG_messenger_desktop/msg_sent_len5_4.png", SCALE)
define cg_screen_messenger_sent_len5_5 = im.FactorScale("CG_messenger_desktop/msg_sent_len5_5.png", SCALE)
define cg_screen_messenger_sent_len5_6 = im.FactorScale("CG_messenger_desktop/msg_sent_len5_6.png", SCALE)



define cg_screen_messenger_sent_history1 = im.FactorScale("CG_messenger_desktop/msg_sent_history1.png", SCALE)
define cg_screen_messenger_sent_history2 = im.FactorScale("CG_messenger_desktop/msg_sent_history2.png", SCALE)


define cg_screen_messenger_recv_passport0 = im.FactorScale("CG_messenger_desktop/msg_received_passport0.png", SCALE)
define cg_screen_messenger_recv_passport1 = im.FactorScale("CG_messenger_desktop/msg_received_passport1.png", SCALE)
define cg_screen_messenger_recv_passport2 = im.FactorScale("CG_messenger_desktop/msg_received_passport2.png", SCALE)
define cg_screen_messenger_recv_passport3 = im.FactorScale("CG_messenger_desktop/msg_received_passport3.png", SCALE)
define cg_screen_messenger_recv_passport4 = im.FactorScale("CG_messenger_desktop/msg_received_passport4.png", SCALE)
define cg_screen_messenger_recv_passport5 = im.FactorScale("CG_messenger_desktop/msg_received_passport5.png", SCALE)
define cg_screen_messenger_recv_passport6 = im.FactorScale("CG_messenger_desktop/msg_received_passport6.png", SCALE)
define cg_screen_messenger_recv_passport7 = im.FactorScale("CG_messenger_desktop/msg_received_passport7.png", SCALE)
define cg_screen_messenger_recv_passport8 = im.FactorScale("CG_messenger_desktop/msg_received_passport8.png", SCALE)
define cg_screen_messenger_recv_passport9 = im.FactorScale("CG_messenger_desktop/msg_received_passport9.png", SCALE)

define cg_screen_messenger_recv_link = im.FactorScale("CG_messenger_desktop/msg_received_link.png", SCALE)


define cg_screen_messenger_none = Null()



define cg_phone_messenger_recv_len0 = im.FactorScale("CG_messenger_phone/msg_phone_received_len0.png", SCALE)
define cg_phone_messenger_recv_len1 = im.FactorScale("CG_messenger_phone/msg_phone_received_len1.png", SCALE)
define cg_phone_messenger_recv_len2 = im.FactorScale("CG_messenger_phone/msg_phone_received_len2.png", SCALE)
define cg_phone_messenger_recv_len3 = im.FactorScale("CG_messenger_phone/msg_phone_received_len3.png", SCALE)
define cg_phone_messenger_recv_len4 = im.FactorScale("CG_messenger_phone/msg_phone_received_len4.png", SCALE)
define cg_phone_messenger_recv_len5_1 = im.FactorScale("CG_messenger_phone/msg_phone_received_len5_1.png", SCALE)
define cg_phone_messenger_recv_len5_2 = im.FactorScale("CG_messenger_phone/msg_phone_received_len5_2.png", SCALE)
define cg_phone_messenger_recv_len5_3 = im.FactorScale("CG_messenger_phone/msg_phone_received_len5_3.png", SCALE)
define cg_phone_messenger_recv_len5_4 = im.FactorScale("CG_messenger_phone/msg_phone_received_len5_4.png", SCALE)
define cg_phone_messenger_recv_len5_5 = im.FactorScale("CG_messenger_phone/msg_phone_received_len5_5.png", SCALE)
define cg_phone_messenger_recv_len5_6 = im.FactorScale("CG_messenger_phone/msg_phone_received_len5_6.png", SCALE)

define cg_phone_messenger_sent_len0 = im.FactorScale("CG_messenger_phone/msg_phone_sent_len0.png", SCALE)
define cg_phone_messenger_sent_len1 = im.FactorScale("CG_messenger_phone/msg_phone_sent_len1.png", SCALE)
define cg_phone_messenger_sent_len2 = im.FactorScale("CG_messenger_phone/msg_phone_sent_len2.png", SCALE)
define cg_phone_messenger_sent_len3 = im.FactorScale("CG_messenger_phone/msg_phone_sent_len3.png", SCALE)
define cg_phone_messenger_sent_len4 = im.FactorScale("CG_messenger_phone/msg_phone_sent_len4.png", SCALE)
define cg_phone_messenger_sent_len5_1 = im.FactorScale("CG_messenger_phone/msg_phone_sent_len5_1.png", SCALE)
define cg_phone_messenger_sent_len5_2 = im.FactorScale("CG_messenger_phone/msg_phone_sent_len5_2.png", SCALE)
define cg_phone_messenger_sent_len5_3 = im.FactorScale("CG_messenger_phone/msg_phone_sent_len5_3.png", SCALE)
define cg_phone_messenger_sent_len5_4 = im.FactorScale("CG_messenger_phone/msg_phone_sent_len5_4.png", SCALE)
define cg_phone_messenger_sent_len5_5 = im.FactorScale("CG_messenger_phone/msg_phone_sent_len5_5.png", SCALE)
define cg_phone_messenger_sent_len5_6 = im.FactorScale("CG_messenger_phone/msg_phone_sent_len5_6.png", SCALE)


define cg_phone_messenger_sent_qr0 = im.FactorScale("CG_messenger_phone/msg_phone_sent_qr0.png", SCALE)
define cg_phone_messenger_sent_qr1 = im.FactorScale("CG_messenger_phone/msg_phone_sent_qr1.png", SCALE)
define cg_phone_messenger_sent_qr2 = im.FactorScale("CG_messenger_phone/msg_phone_sent_qr2.png", SCALE)
define cg_phone_messenger_sent_qr3 = im.FactorScale("CG_messenger_phone/msg_phone_sent_qr3.png", SCALE)
define cg_phone_messenger_sent_qr4 = im.FactorScale("CG_messenger_phone/msg_phone_sent_qr4.png", SCALE)
define cg_phone_messenger_sent_qr5 = im.FactorScale("CG_messenger_phone/msg_phone_sent_qr5.png", SCALE)
define cg_phone_messenger_sent_qr6 = im.FactorScale("CG_messenger_phone/msg_phone_sent_qr6.png", SCALE)
define cg_phone_messenger_sent_qr7 = im.FactorScale("CG_messenger_phone/msg_phone_sent_qr7.png", SCALE)

define cg_phone_messenger_received_link = im.FactorScale("CG_messenger_phone/msg_phone_received_link.png", SCALE)


define cg_phone_messenger_none = Null()






# 910, 278 in window 1920x1080 which is 0.474, 0.2574
# 910, 302 in window 1920x1080 which is 0.474, 0.2796
# 910, 326 in window 1920x1080 which is 0.474, 0.3019
# 910, 350 in window 1920x1080 which is 0.474, 0.3241
# 910, 374 in window 1920x1080 which is 0.474, 0.3463
# 910, 398 in window 1920x1080 which is 0.474, 0.3685
# 910, 422 in window 1920x1080 which is 0.474, 0.3907
# 910, 446 in window 1920x1080 which is 0.474, 0.413
# 910, 470 in window 1920x1080 which is 0.474, 0.4352
# 910, 494 in window 1920x1080 which is 0.474, 0.4574
define msg_xpos_desktop = 0.474

define msg_width_desktop = 0.13125 # 252.0  / 1920.0

# this is to avoid space between messages images in Desktop version (especially when showing passport on Day 2)
define desktopExtraShiftY = 0.001

define msg_ypos_desktop_minus1 = 0.2352 # This usually is not visible on screen anyway
define msg_ypos_desktop0 = 0.2574
define msg_ypos_desktop1 = 0.2796
define msg_ypos_desktop2 = 0.3019-desktopExtraShiftY
define msg_ypos_desktop3 = 0.3241-desktopExtraShiftY
define msg_ypos_desktop4 = 0.3463-desktopExtraShiftY
define msg_ypos_desktop5 = 0.3685-desktopExtraShiftY

define msg_ypos_desktop6 = 0.3907-desktopExtraShiftY
define msg_ypos_desktop7 = 0.413-desktopExtraShiftY
define msg_ypos_desktop8 = 0.4352-desktopExtraShiftY
define msg_ypos_desktop9 = 0.4574-desktopExtraShiftY




define msg_position_desktop_minus1 = Position(xpos=msg_xpos_desktop, ypos=msg_ypos_desktop_minus1, xanchor=0.0, yanchor=0.0) # This usually is not visible on screen anyway
define msg_position_desktop0 = Position(xpos=msg_xpos_desktop, ypos=msg_ypos_desktop0, xanchor=0.0, yanchor=0.0)
define msg_position_desktop1 = Position(xpos=msg_xpos_desktop, ypos=msg_ypos_desktop1, xanchor=0.0, yanchor=0.0)
define msg_position_desktop2 = Position(xpos=msg_xpos_desktop, ypos=msg_ypos_desktop2, xanchor=0.0, yanchor=0.0)
define msg_position_desktop3 = Position(xpos=msg_xpos_desktop, ypos=msg_ypos_desktop3, xanchor=0.0, yanchor=0.0)
define msg_position_desktop4 = Position(xpos=msg_xpos_desktop, ypos=msg_ypos_desktop4, xanchor=0.0, yanchor=0.0)
define msg_position_desktop5 = Position(xpos=msg_xpos_desktop, ypos=msg_ypos_desktop5, xanchor=0.0, yanchor=0.0)
define msg_position_desktop6 = Position(xpos=msg_xpos_desktop, ypos=msg_ypos_desktop6, xanchor=0.0, yanchor=0.0)
define msg_position_desktop7 = Position(xpos=msg_xpos_desktop, ypos=msg_ypos_desktop7, xanchor=0.0, yanchor=0.0)
define msg_position_desktop8 = Position(xpos=msg_xpos_desktop, ypos=msg_ypos_desktop8, xanchor=0.0, yanchor=0.0)
define msg_position_desktop9 = Position(xpos=msg_xpos_desktop, ypos=msg_ypos_desktop9, xanchor=0.0, yanchor=0.0)

define msg_height_desktop = msg_ypos_desktop1 - msg_ypos_desktop0


# this is to avoid space between messages' images in Phone version (especially when showing QR code of Aeroexpress on Day 3)
#define extraShiftY = 0.0014
define extraShiftY = 0.001

#1276, 396 in window 1920x1080 which is 0.6646, 0.3667
#1276, 428 in window 1920x1080 which is 0.6646, 0.3963
#1276, 460 in window 1920x1080 which is 0.6646, 0.4259
#1276, 492 in window 1920x1080 which is 0.6646, 0.4556
#1276, 524 in window 1920x1080 which is 0.6646, 0.4852
#1276, 556 in window 1920x1080 which is 0.6646, 0.5148
#1276, 588 in window 1920x1080 which is 0.6646, 0.5444
#1276, 620 in window 1920x1080 which is 0.6646, 0.5741
#1276, 652 in window 1920x1080 which is 0.6646, 0.6037
#1276, 684 in window 1920x1080 which is 0.6646, 0.6333
define msg_xpos_phone = 0.6646
define msg_width_phone = 0.114583 # 220 / 1920

define msg_ypos_phone_minus1 = 0.3371 # This usually is not visible on screen anyway
define msg_ypos_phone0 = 0.3667
define msg_ypos_phone1 = 0.3963
define msg_ypos_phone2 = 0.4259
define msg_ypos_phone3 = 0.4556 - extraShiftY
define msg_ypos_phone4 = 0.4852 - extraShiftY
define msg_ypos_phone5 = 0.5148 - extraShiftY
define msg_ypos_phone6 = 0.5444 - extraShiftY*2
define msg_ypos_phone7 = 0.5741 - extraShiftY*2
define msg_ypos_phone8 = 0.6037 - extraShiftY*3
define msg_ypos_phone9 = 0.6333 - extraShiftY*3

define msg_height_phone = msg_ypos_phone1 - msg_ypos_phone0



define msg_position_phone_minus1 = Position(xpos=msg_xpos_phone, ypos=msg_ypos_phone_minus1, xanchor=0.0, yanchor=0.0) # This usually is not visible on screen anyway
define msg_position_phone0 = Position(xpos=msg_xpos_phone, ypos=msg_ypos_phone0, xanchor=0.0, yanchor=0.0)
define msg_position_phone1 = Position(xpos=msg_xpos_phone, ypos=msg_ypos_phone1, xanchor=0.0, yanchor=0.0)
define msg_position_phone2 = Position(xpos=msg_xpos_phone, ypos=msg_ypos_phone2, xanchor=0.0, yanchor=0.0)
define msg_position_phone3 = Position(xpos=msg_xpos_phone, ypos=msg_ypos_phone3, xanchor=0.0, yanchor=0.0)
define msg_position_phone4 = Position(xpos=msg_xpos_phone, ypos=msg_ypos_phone4, xanchor=0.0, yanchor=0.0)
define msg_position_phone5 = Position(xpos=msg_xpos_phone, ypos=msg_ypos_phone5, xanchor=0.0, yanchor=0.0)
define msg_position_phone6 = Position(xpos=msg_xpos_phone, ypos=msg_ypos_phone6, xanchor=0.0, yanchor=0.0)
define msg_position_phone7 = Position(xpos=msg_xpos_phone, ypos=msg_ypos_phone7, xanchor=0.0, yanchor=0.0)
define msg_position_phone8 = Position(xpos=msg_xpos_phone, ypos=msg_ypos_phone8, xanchor=0.0, yanchor=0.0)
define msg_position_phone9 = Position(xpos=msg_xpos_phone, ypos=msg_ypos_phone9, xanchor=0.0, yanchor=0.0)


# Adding empty message for each dialog, to fill the area at pos (-1) right under the mess
default var_message_queue = {
    'coach' : [{'special': True, 'type': 0, 'phoneType' : 0}],
    'minjun' : [{'special': True, 'type': 0, 'phoneType' : 0}],
    'aliya' : [{'special': True, 'type': 0, 'phoneType' : 0}],
    'yarik' : [{'special': True, 'type': 0, 'phoneType' : 0}]
    }


default var_last_received_message_option_len5 = 0 # to make sure new received message of length 5 will not be same as previous one
default var_last_sent_message_option_len5 = 0 # to make sure new received message of length 5 will not be same as previous one


default var_current_dialog = 'coach'

default var_current_dialog_order = [] # thd order of dialog in messenger left panel, depends on with whom user talked last

default var_message_count_coach = 1

default var_message_count_minjun = 1

default var_message_count_aliya = 1

default var_message_count_yarik = 1

default var_messenger_is_phone = False




transform desktopTransitionLast():
    zoom 0.0
    linear 0.2 zoom 1.0

transform desktopTransitionPrevious(new_ypos=msg_ypos_desktop0):
    xpos msg_xpos_desktop
    ypos (new_ypos + msg_height_desktop)
    linear 0.2 ypos new_ypos

transform desktopTransitionPreviousDissolve(new_ypos=msg_ypos_desktop0):
    xpos msg_xpos_desktop
    ypos (new_ypos + msg_height_desktop)
    alpha 0.0
    linear 0.2 ypos new_ypos alpha 1.0

transform desktopTransitionAppearLeft(new_ypos=msg_ypos_desktop0):
    xpos msg_xpos_desktop
    ypos new_ypos
    zoom 0.0
    linear 0.2 zoom 1.0

transform desktopTransitionAppearRight(new_ypos=msg_ypos_desktop0):
    xpos msg_xpos_desktop + msg_width_desktop
    xanchor 1.0
    ypos new_ypos
    zoom 0.0
    linear 0.2 zoom 1.0
    xpos msg_xpos_desktop
    xanchor 0.0

transform desktopTransitionAppearLeftFromBottom(new_ypos=msg_ypos_desktop0):
    xpos msg_xpos_desktop
    yanchor 1.0
    ypos new_ypos+msg_height_desktop
    zoom 0.0
    linear 0.2 zoom 1.0
    ypos new_ypos
    yanchor 0.0

transform desktopTransitionAppearRightFromBottom(new_ypos=msg_ypos_desktop0):
    xpos msg_xpos_desktop + msg_width_desktop
    xanchor 1.0
    yanchor 1.0
    ypos new_ypos+msg_height_desktop
    zoom 0.0
    linear 0.2 zoom 1.0
    xpos msg_xpos_desktop
    xanchor 0.0
    ypos new_ypos
    yanchor 0.0

transform desktopTransitionNone(new_ypos=msg_ypos_desktop0):
    xpos msg_xpos_desktop
    ypos new_ypos


transform desktopTransitionLast():
    zoom 0.0
    linear 0.2 zoom 1.0

transform phoneTransitionPrevious(new_ypos=msg_ypos_phone0):
    xpos msg_xpos_phone
    ypos (new_ypos + msg_height_phone)
    linear 0.2 ypos new_ypos

transform phoneTransitionPreviousDissolve(new_ypos=msg_ypos_phone0):
    xpos msg_xpos_phone
    ypos (new_ypos + msg_height_phone)
    alpha 0.0
    linear 0.2 ypos new_ypos alpha 1.0

transform phoneTransitionAppearLeft(new_ypos=msg_ypos_phone0):
    xpos msg_xpos_phone
    ypos new_ypos
    zoom 0.0
    linear 0.2 zoom 1.0


transform phoneTransitionAppearRight(new_ypos=msg_ypos_phone0):
    xpos msg_xpos_phone + msg_width_phone
    xanchor 1.0
    ypos new_ypos
    zoom 0.0
    linear 0.2 zoom 1.0
    xpos msg_xpos_phone
    xanchor 0.0

transform phoneTransitionAppearLeftFromBottom(new_ypos=msg_ypos_phone0):
    yanchor 1.0
    xpos msg_xpos_phone
    ypos new_ypos + msg_height_phone
    zoom 0.0
    linear 0.2 zoom 1.0
    ypos new_ypos
    yanchor 0.0

transform phoneTransitionAppearRightFromBottom(new_ypos=msg_ypos_phone0):
    xpos msg_xpos_phone + msg_width_phone
    xanchor 1.0
    yanchor 1.0
    ypos new_ypos + msg_height_phone
    zoom 0.0
    linear 0.2 zoom 1.0
    xpos msg_xpos_phone
    xanchor 0.0
    ypos new_ypos
    yanchor 0.0


transform phoneTransitionNone(new_ypos=msg_ypos_phone0):
    xpos msg_xpos_phone
    ypos new_ypos








init python:

    global var_msg_ypos_desktop # Const
    global var_msg_positions_desktop # Const
    global var_msg_ypos_phone # Const
    global var_msg_positions_phone # Const
    global var_message_queue
    global var_current_dialog
    global var_current_dialog_order

    global var_recv_msg_length_images_desktop  # Const
    global var_sent_msg_length_images_desktop  # Const
    global var_special_msg_image_names_desktop  # Const

    global var_recv_msg_length_images_phone  # Const
    global var_sent_msg_length_images_phone  # Const


    var_msg_positions_desktop = [msg_position_desktop_minus1, msg_position_desktop0, msg_position_desktop1, msg_position_desktop2, msg_position_desktop3, msg_position_desktop4, msg_position_desktop5, msg_position_desktop6, msg_position_desktop7, msg_position_desktop8, msg_position_desktop9]
    var_msg_ypos_desktop = [msg_ypos_desktop_minus1, msg_ypos_desktop0, msg_ypos_desktop1, msg_ypos_desktop2, msg_ypos_desktop3, msg_ypos_desktop4, msg_ypos_desktop5, msg_ypos_desktop6, msg_ypos_desktop7, msg_ypos_desktop8, msg_ypos_desktop9]


    var_msg_positions_phone = [msg_position_phone_minus1, msg_position_phone0, msg_position_phone1, msg_position_phone2, msg_position_phone3, msg_position_phone4, msg_position_phone5, msg_position_phone6, msg_position_phone7, msg_position_phone8, msg_position_phone9]
    var_msg_ypos_phone = [msg_ypos_phone_minus1, msg_ypos_phone0, msg_ypos_phone1, msg_ypos_phone2, msg_ypos_phone3, msg_ypos_phone4, msg_ypos_phone5, msg_ypos_phone6, msg_ypos_phone7, msg_ypos_phone8, msg_ypos_phone9]

    renpy.image("cg_screen_messenger_recv_len0", cg_screen_messenger_recv_len0)
    renpy.image("cg_screen_messenger_recv_len1", cg_screen_messenger_recv_len1)
    renpy.image("cg_screen_messenger_recv_len2", cg_screen_messenger_recv_len2)
    renpy.image("cg_screen_messenger_recv_len3", cg_screen_messenger_recv_len3)
    renpy.image("cg_screen_messenger_recv_len4", cg_screen_messenger_recv_len4)
    renpy.image("cg_screen_messenger_recv_len5_1", cg_screen_messenger_recv_len5_1)
    renpy.image("cg_screen_messenger_recv_len5_2", cg_screen_messenger_recv_len5_2)
    renpy.image("cg_screen_messenger_recv_len5_3", cg_screen_messenger_recv_len5_3)
    renpy.image("cg_screen_messenger_recv_len5_4", cg_screen_messenger_recv_len5_4)
    renpy.image("cg_screen_messenger_recv_len5_5", cg_screen_messenger_recv_len5_5)
    renpy.image("cg_screen_messenger_recv_len5_6", cg_screen_messenger_recv_len5_6)


    renpy.image("cg_screen_messenger_sent_len0", cg_screen_messenger_sent_len0)
    renpy.image("cg_screen_messenger_sent_len1", cg_screen_messenger_sent_len1)
    renpy.image("cg_screen_messenger_sent_len2", cg_screen_messenger_sent_len2)
    renpy.image("cg_screen_messenger_sent_len3", cg_screen_messenger_sent_len3)
    renpy.image("cg_screen_messenger_sent_len4", cg_screen_messenger_sent_len4)
    renpy.image("cg_screen_messenger_sent_len5_1", cg_screen_messenger_sent_len5_1)
    renpy.image("cg_screen_messenger_sent_len5_2", cg_screen_messenger_sent_len5_2)
    renpy.image("cg_screen_messenger_sent_len5_3", cg_screen_messenger_sent_len5_3)
    renpy.image("cg_screen_messenger_sent_len5_4", cg_screen_messenger_sent_len5_4)
    renpy.image("cg_screen_messenger_sent_len5_5", cg_screen_messenger_sent_len5_5)
    renpy.image("cg_screen_messenger_sent_len5_6", cg_screen_messenger_sent_len5_6)

    renpy.image("cg_screen_messenger_sent_history1", cg_screen_messenger_sent_history1)
    renpy.image("cg_screen_messenger_sent_history2", cg_screen_messenger_sent_history2)


    renpy.image("cg_screen_messenger_recv_passport0", cg_screen_messenger_recv_passport0)
    renpy.image("cg_screen_messenger_recv_passport1", cg_screen_messenger_recv_passport1)
    renpy.image("cg_screen_messenger_recv_passport2", cg_screen_messenger_recv_passport2)
    renpy.image("cg_screen_messenger_recv_passport3", cg_screen_messenger_recv_passport3)
    renpy.image("cg_screen_messenger_recv_passport4", cg_screen_messenger_recv_passport4)
    renpy.image("cg_screen_messenger_recv_passport5", cg_screen_messenger_recv_passport5)
    renpy.image("cg_screen_messenger_recv_passport6", cg_screen_messenger_recv_passport6)
    renpy.image("cg_screen_messenger_recv_passport7", cg_screen_messenger_recv_passport7)
    renpy.image("cg_screen_messenger_recv_passport8", cg_screen_messenger_recv_passport8)
    renpy.image("cg_screen_messenger_recv_passport9", cg_screen_messenger_recv_passport9)
    renpy.image("cg_screen_messenger_recv_link", cg_screen_messenger_recv_link)
    renpy.image("cg_screen_messenger_none", cg_screen_messenger_none)


    renpy.image("cg_phone_messenger_recv_len0", cg_phone_messenger_recv_len0)
    renpy.image("cg_phone_messenger_recv_len1", cg_phone_messenger_recv_len1)
    renpy.image("cg_phone_messenger_recv_len2", cg_phone_messenger_recv_len2)
    renpy.image("cg_phone_messenger_recv_len3", cg_phone_messenger_recv_len3)
    renpy.image("cg_phone_messenger_recv_len4", cg_phone_messenger_recv_len4)
    renpy.image("cg_phone_messenger_recv_len5_1", cg_phone_messenger_recv_len5_1)
    renpy.image("cg_phone_messenger_recv_len5_2", cg_phone_messenger_recv_len5_2)
    renpy.image("cg_phone_messenger_recv_len5_3", cg_phone_messenger_recv_len5_3)
    renpy.image("cg_phone_messenger_recv_len5_4", cg_phone_messenger_recv_len5_4)
    renpy.image("cg_phone_messenger_recv_len5_5", cg_phone_messenger_recv_len5_5)
    renpy.image("cg_phone_messenger_recv_len5_6", cg_phone_messenger_recv_len5_6)


    renpy.image("cg_phone_messenger_sent_len0", cg_phone_messenger_sent_len0)
    renpy.image("cg_phone_messenger_sent_len1", cg_phone_messenger_sent_len1)
    renpy.image("cg_phone_messenger_sent_len2", cg_phone_messenger_sent_len2)
    renpy.image("cg_phone_messenger_sent_len3", cg_phone_messenger_sent_len3)
    renpy.image("cg_phone_messenger_sent_len4", cg_phone_messenger_sent_len4)
    renpy.image("cg_phone_messenger_sent_len5_1", cg_phone_messenger_sent_len5_1)
    renpy.image("cg_phone_messenger_sent_len5_2", cg_phone_messenger_sent_len5_2)
    renpy.image("cg_phone_messenger_sent_len5_3", cg_phone_messenger_sent_len5_3)
    renpy.image("cg_phone_messenger_sent_len5_4", cg_phone_messenger_sent_len5_4)
    renpy.image("cg_phone_messenger_sent_len5_5", cg_phone_messenger_sent_len5_5)
    renpy.image("cg_phone_messenger_sent_len5_6", cg_phone_messenger_sent_len5_6)

    renpy.image("cg_phone_messenger_sent_qr0", cg_phone_messenger_sent_qr0)
    renpy.image("cg_phone_messenger_sent_qr1", cg_phone_messenger_sent_qr1)
    renpy.image("cg_phone_messenger_sent_qr2", cg_phone_messenger_sent_qr2)
    renpy.image("cg_phone_messenger_sent_qr3", cg_phone_messenger_sent_qr3)
    renpy.image("cg_phone_messenger_sent_qr4", cg_phone_messenger_sent_qr4)
    renpy.image("cg_phone_messenger_sent_qr5", cg_phone_messenger_sent_qr5)
    renpy.image("cg_phone_messenger_sent_qr6", cg_phone_messenger_sent_qr6)
    renpy.image("cg_phone_messenger_sent_qr7", cg_phone_messenger_sent_qr7)
    renpy.image("cg_phone_messenger_received_link", cg_phone_messenger_received_link)
    renpy.image("cg_phone_messenger_none", cg_phone_messenger_none)


    var_recv_msg_length_image_names_desktop = [['cg_screen_messenger_recv_len0'], ['cg_screen_messenger_recv_len1'], ['cg_screen_messenger_recv_len2'], ['cg_screen_messenger_recv_len3'], ['cg_screen_messenger_recv_len4'], ['cg_screen_messenger_recv_len5_1', 'cg_screen_messenger_recv_len5_2', 'cg_screen_messenger_recv_len5_3', 'cg_screen_messenger_recv_len5_4', 'cg_screen_messenger_recv_len5_5', 'cg_screen_messenger_recv_len5_6']]

    var_sent_msg_length_image_names_desktop = [['cg_screen_messenger_sent_len0'], ['cg_screen_messenger_sent_len1'], ['cg_screen_messenger_sent_len2'], ['cg_screen_messenger_sent_len3'], ['cg_screen_messenger_sent_len4'], ['cg_screen_messenger_sent_len5_1', 'cg_screen_messenger_sent_len5_2', 'cg_screen_messenger_sent_len5_3', 'cg_screen_messenger_sent_len5_4', 'cg_screen_messenger_sent_len5_5', 'cg_screen_messenger_sent_len5_6']]

    var_special_msg_image_names_desktop = ['cg_screen_messenger_none', 'cg_screen_messenger_recv_passport0', 'cg_screen_messenger_recv_passport1', 'cg_screen_messenger_recv_passport2', 'cg_screen_messenger_recv_passport3', 'cg_screen_messenger_recv_passport4', 'cg_screen_messenger_recv_passport5', 'cg_screen_messenger_recv_passport6', 'cg_screen_messenger_recv_passport7', 'cg_screen_messenger_recv_passport8', 'cg_screen_messenger_recv_passport9', 'cg_screen_messenger_recv_link', 'cg_screen_messenger_sent_history1', 'cg_screen_messenger_sent_history2']


    var_recv_msg_length_image_names_phone = [['cg_phone_messenger_recv_len0'], ['cg_phone_messenger_recv_len1'], ['cg_phone_messenger_recv_len2'], ['cg_phone_messenger_recv_len3'], ['cg_phone_messenger_recv_len4'], ['cg_phone_messenger_recv_len5_1', 'cg_phone_messenger_recv_len5_2', 'cg_phone_messenger_recv_len5_3', 'cg_phone_messenger_recv_len5_4', 'cg_phone_messenger_recv_len5_5', 'cg_phone_messenger_recv_len5_6']]

    var_sent_msg_length_image_names_phone = [['cg_phone_messenger_sent_len0'], ['cg_phone_messenger_sent_len1'], ['cg_phone_messenger_sent_len2'], ['cg_phone_messenger_sent_len3'], ['cg_phone_messenger_sent_len4'], ['cg_phone_messenger_sent_len5_1', 'cg_phone_messenger_sent_len5_2', 'cg_phone_messenger_sent_len5_3', 'cg_phone_messenger_sent_len5_4', 'cg_phone_messenger_sent_len5_5', 'cg_phone_messenger_sent_len5_6']]

    var_special_msg_image_names_phone = ['cg_phone_messenger_none', 'cg_phone_messenger_sent_qr0', 'cg_phone_messenger_sent_qr1', 'cg_phone_messenger_sent_qr2', 'cg_phone_messenger_sent_qr3', 'cg_phone_messenger_sent_qr4', 'cg_phone_messenger_sent_qr5', 'cg_phone_messenger_sent_qr6', 'cg_phone_messenger_sent_qr7', 'cg_phone_messenger_received_link']

    def switchMessengerToPhone():
        global var_messenger_is_phone
        var_messenger_is_phone = True


    def incrementDialogMessageCounter(val):
        global var_message_count_coach
        global var_message_count_minjun
        global var_message_count_aliya
        global var_message_count_yarik

        if var_current_dialog == 'coach':
            var_message_count_coach += val
        elif var_current_dialog == 'minjun':
            var_message_count_minjun += val
        elif var_current_dialog == 'aliya':
            var_message_count_aliya += val
        else:
            var_message_count_yarik += val

    def getDialogMessageCounter():
        messageCount = 0

        if var_current_dialog == 'coach':
            messageCount = var_message_count_coach
        elif var_current_dialog == 'minjun':
            messageCount = var_message_count_minjun
        elif var_current_dialog == 'aliya':
            messageCount = var_message_count_aliya
        else:
            messageCount = var_message_count_yarik

        return messageCount


    def innerAddMessage(content):
        global var_message_queue
        global var_current_dialog

        messageCount = getDialogMessageCounter()

        if len(var_message_queue[var_current_dialog]) < messageCount:
            var_message_queue[var_current_dialog].append(content)




    def addReceivedMessage(messageLength):

        global var_recv_msg_length_image_names_desktop

        global var_last_received_message_option_len5

        optionsCount = len(var_recv_msg_length_image_names_desktop[messageLength])

        selectedOption = 0

        if optionsCount > 1:
            optionList = list(range(0, optionsCount))
            optionList.remove(var_last_received_message_option_len5)
            selectedOption = renpy.random.choice(optionList)

            var_last_received_message_option_len5 = selectedOption # we have multiple options only for messages of length 5

        incrementDialogMessageCounter(1)

        innerAddMessage({'leftSide': True, 'length': messageLength, 'option' : selectedOption})

        drawMessages()



    def addSentMessage(messageLength):

        global var_sent_msg_length_image_names_desktop

        global var_last_sent_message_option_len5

        optionsCount = len(var_sent_msg_length_image_names_desktop[messageLength])

        selectedOption = 0

        if optionsCount > 1:
            optionList = list(range(0, optionsCount))
            optionList.remove(var_last_sent_message_option_len5)
            selectedOption = renpy.random.choice(optionList)

            var_last_sent_message_option_len5 = selectedOption # we have multiple options only for messages of length 5


        incrementDialogMessageCounter(1)

        innerAddMessage({'leftSide': False, 'length': messageLength, 'option' : selectedOption})

        drawMessages()


    def addReceivedMessagePassport():
        incrementDialogMessageCounter(10)

        innerAddMessage({'special': True, 'type' : 1})
        innerAddMessage({'special': True, 'type' : 2})
        innerAddMessage({'special': True, 'type' : 3})
        innerAddMessage({'special': True, 'type' : 4})
        innerAddMessage({'special': True, 'type' : 5})
        innerAddMessage({'special': True, 'type' : 6})
        innerAddMessage({'special': True, 'type' : 7})
        innerAddMessage({'special': True, 'type' : 8})
        innerAddMessage({'special': True, 'type' : 9})
        innerAddMessage({'special': True, 'type' : 10})

        drawMessages()

    def addReceivedMessageLink():
        incrementDialogMessageCounter(1)
        innerAddMessage({'special': True, 'type' : 11, 'phoneType' : 9})

        drawMessages()

    def addSentMessageHistory():
        incrementDialogMessageCounter(2)
        innerAddMessage({'special': True, 'type' : 12})
        innerAddMessage({'special': True, 'type' : 13})
        drawMessages()

    def addSentMessageQr():
        incrementDialogMessageCounter(8)

        innerAddMessage({'special': True, 'phoneType' : 1})
        innerAddMessage({'special': True, 'phoneType' : 2})
        innerAddMessage({'special': True, 'phoneType' : 3})
        innerAddMessage({'special': True, 'phoneType' : 4})
        innerAddMessage({'special': True, 'phoneType' : 5})
        innerAddMessage({'special': True, 'phoneType' : 6})
        innerAddMessage({'special': True, 'phoneType' : 7})
        innerAddMessage({'special': True, 'phoneType' : 8})

        drawMessages()


    def clearDisplayMessages():
        for i in range(len(var_msg_positions_desktop)):
            renpy.hide("screen_msg_pos" + str(i))
            renpy.with_statement(None)


    def clearMessagesAfterBan():

        var_message_queue['aliya'] = []

        for i in range(len(var_msg_positions_desktop)):
            renpy.hide("screen_msg_pos" + str(i))


    def changeDialog(characher):
        global var_current_dialog
        global var_current_dialog_order

        var_current_dialog = characher
        clearDisplayMessages()

        if characher in var_current_dialog_order:
            var_current_dialog_order.remove(characher)

        var_current_dialog_order = [characher] + var_current_dialog_order

    def changeDialogToCoach():
        changeDialog('coach')

    def changeDialogToMinjun():
        changeDialog('minjun')

    def changeDialogToAliya():
        changeDialog('aliya')

    def changeDialogToYarik():
        changeDialog('yarik')

    def showMessengerWithRightOrder():

        global var_current_dialog_order

        if var_current_dialog_order == ['coach']:
            renpy.show("cg_screen_messenger_window_coach_x", tag="cg_screen_messenger_window", at_list=[cg_screen_messenger_window_pos])
            renpy.show("cg_screen_messenger_window_top_coach", tag="cg_screen_messenger_window_top", at_list=[cg_screen_messenger_window_pos], zorder=15)


        elif var_current_dialog_order == ['minjun', 'coach']:
            renpy.show("cg_screen_messenger_window_minjun_coach_x", tag="cg_screen_messenger_window", at_list=[cg_screen_messenger_window_pos])
            renpy.show("cg_screen_messenger_window_top_minjun", tag="cg_screen_messenger_window_top", at_list=[cg_screen_messenger_window_pos], zorder=15)


        elif var_current_dialog_order == ['aliya', 'minjun', 'coach']:
            if aliya_banned:
                renpy.show("cg_screen_messenger_window_aliya_banned_minjun_coach_x", tag="cg_screen_messenger_window", at_list=[cg_screen_messenger_window_pos])
            else:
                renpy.show("cg_screen_messenger_window_aliya_minjun_coach_x", tag="cg_screen_messenger_window", at_list=[cg_screen_messenger_window_pos])

            renpy.show("cg_screen_messenger_window_top_aliya", tag="cg_screen_messenger_window_top", at_list=[cg_screen_messenger_window_pos], zorder=15)


        elif var_current_dialog_order == ['coach', 'aliya', 'minjun']:
            renpy.show("cg_screen_messenger_window_coach_aliya_minjun_x", tag="cg_screen_messenger_window", at_list=[cg_screen_messenger_window_pos])
            renpy.show("cg_screen_messenger_window_top_coach", tag="cg_screen_messenger_window_top", at_list=[cg_screen_messenger_window_pos], zorder=15)


        elif var_current_dialog_order == ['aliya', 'coach', 'minjun']:
            if aliya_banned:
                renpy.show("cg_screen_messenger_window_aliya_banned_coach_minjun_x", tag="cg_screen_messenger_window", at_list=[cg_screen_messenger_window_pos])
            else:
                renpy.show("cg_screen_messenger_window_aliya_coach_minjun_x", tag="cg_screen_messenger_window", at_list=[cg_screen_messenger_window_pos])

            renpy.show("cg_screen_messenger_window_top_aliya", tag="cg_screen_messenger_window_top", at_list=[cg_screen_messenger_window_pos], zorder=15)


        elif var_current_dialog_order == ['yarik', 'coach', 'aliya', 'minjun']:
            renpy.show("cg_screen_messenger_window_yarik_coach_aliya_minjun_x", tag="cg_screen_messenger_window", at_list=[cg_screen_messenger_window_pos])
            renpy.show("cg_screen_messenger_window_top_yarik", tag="cg_screen_messenger_window_top", at_list=[cg_screen_messenger_window_pos], zorder=15)


        elif var_current_dialog_order == ['aliya', 'yarik', 'coach', 'minjun']:
            renpy.show("cg_screen_messenger_window_aliya_yarik_coach_minjun_x", tag="cg_screen_messenger_window", at_list=[cg_screen_messenger_window_pos])
            renpy.show("cg_screen_messenger_window_top_yarik", tag="cg_screen_messenger_window_top", at_list=[cg_screen_messenger_window_pos], zorder=15)


        else:
            renpy.show("cg_screen_messenger_window_coach_x", tag="cg_screen_messenger_window", at_list=[cg_screen_messenger_window_pos])
            renpy.show("cg_screen_messenger_window_top_coach", tag="cg_screen_messenger_window_top", at_list=[cg_screen_messenger_window_pos], zorder=15)

        drawMessages(force_no_transition=True)

    def showMessengerPhone(is_night=False, force_no_transition=False):
        global var_current_dialog_order

        if is_night:
            renpy.show("cg_screen_phone_messenger_night", tag="cg_screen_phone")
        else:
            renpy.show("cg_screen_phone_messenger", tag="cg_screen_phone")

        if var_current_dialog_order[0] == 'coach':
            renpy.show("cg_screen_phone_messenger_top_coach", tag="cg_screen_phone_top", at_list=[cg_sceen_phone_top_pos], zorder=15)
        elif var_current_dialog_order[0] == 'aliya':
            if aliya_banned:
                renpy.show("cg_screen_phone_messenger_top_aliya_banned", tag="cg_screen_phone_top", at_list=[cg_sceen_phone_top_pos], zorder=15)
            else:
                renpy.show("cg_screen_phone_messenger_top_aliya", tag="cg_screen_phone_top", at_list=[cg_sceen_phone_top_pos], zorder=15)

        else:
            #Yarik
            renpy.show("cg_screen_phone_messenger_top_yarik", tag="cg_screen_phone_top", at_list=[cg_sceen_phone_top_pos], zorder=15)

        drawMessagesPhone(force_no_transition)

    def hidePhone():
        clearDisplayMessages()
        renpy.hide("cg_screen_phone")
        renpy.hide("cg_screen_phone_top")



    def drawSingleMessageDesktop(i, rangeLen, queueLen, msg, force_no_transition=False):
        global var_msg_ypos_desktop # Const
        global var_msg_positions_desktop
        global var_recv_msg_length_images_desktop
        global var_sent_msg_length_images_desktop
        global var_special_msg_image_names_desktop


        messengerMaxLen = len(var_msg_positions_desktop)

        imgName = "screen_msg_pos" + str(i)

        renpy.hide(imgName)
        renpy.with_statement(None)


        if renpy.in_rollback():
            transitionFunc = desktopTransitionNone
        elif renpy.get_skipping():
            transitionFunc = desktopTransitionNone
        elif force_no_transition:
            transitionFunc = desktopTransitionNone
        else:
            if ('special' in msg) and (msg['special']):
                if (msg['type'] == 11): # Website link from Coach
                    if (i == rangeLen-1):
                        transitionFunc = desktopTransitionAppearLeftFromBottom
                    else:
                        transitionFunc = desktopTransitionPrevious
                else:
                    transitionFunc = desktopTransitionPrevious
            else:
                if (rangeLen == messengerMaxLen) and (queueLen > messengerMaxLen):
                    if (i == rangeLen-1):
                        if (msg['leftSide']):
                            transitionFunc = desktopTransitionAppearLeftFromBottom
                        else:
                            transitionFunc = desktopTransitionAppearRightFromBottom
                    else:
                        transitionFunc = desktopTransitionPrevious
                else:
                    if (i == rangeLen-1):
                        if (msg['leftSide']):
                            transitionFunc = desktopTransitionAppearLeft
                        else:
                            transitionFunc = desktopTransitionAppearRight
                    else:
                        transitionFunc = desktopTransitionNone


        #transitionFunc = desktopTransitionNone

        if ('special' in msg) and (msg['special']):
            renpy.show(var_special_msg_image_names_desktop[msg['type']], at_list=[transitionFunc(var_msg_ypos_desktop[i])], tag=imgName, zorder=6)
            renpy.with_statement(None)
        else:
            if (msg['leftSide']):
                renpy.show(var_recv_msg_length_image_names_desktop[msg['length']][msg['option']], at_list=[transitionFunc(var_msg_ypos_desktop[i])], tag=imgName, zorder=6)
                renpy.with_statement(None)
            else:
                renpy.show(var_sent_msg_length_image_names_desktop[msg['length']][msg['option']], at_list=[transitionFunc(var_msg_ypos_desktop[i])], tag=imgName, zorder=6)
                renpy.with_statement(None)


    def drawMessagesDesktop(force_no_transition=False):
        global var_msg_positions_desktop
        global var_message_queue
        global var_recv_msg_length_images_desktop
        global var_sent_msg_length_images_desktop
        global var_special_msg_image_names_desktop

        currentQueue = var_message_queue[var_current_dialog]

        queueLen = len(currentQueue)

        messengerMaxLen = len(var_msg_positions_desktop)

        rangeLen = min(queueLen, messengerMaxLen)

        for i in range(rangeLen):
            msg = currentQueue[i + (queueLen - rangeLen)]
            drawSingleMessageDesktop(i, rangeLen, queueLen, msg, force_no_transition)


    def drawSingleMessagePhone(i, rangeLen, queueLen, msg, force_no_transition=False):

        global var_msg_positions_phone

        messengerMaxLen = len(var_msg_positions_phone)

        imgName = "screen_msg_pos" + str(i)

        renpy.hide(imgName)
        renpy.with_statement(None)



        if renpy.in_rollback():
            transitionFunc = phoneTransitionNone
        elif renpy.get_skipping():
            transitionFunc = phoneTransitionNone
        elif force_no_transition:
            transitionFunc = phoneTransitionNone
        else:
            if ('special' in msg) and (msg['special']):
                if (msg['phoneType'] == 9): # Website link from Coach
                    if (i == rangeLen-1):
                        transitionFunc = phoneTransitionAppearLeftFromBottom
                    else:
                        transitionFunc = phoneTransitionPrevious
                else:
                    transitionFunc = phoneTransitionPrevious
            else:
                if (rangeLen == messengerMaxLen) and (queueLen > messengerMaxLen):
                    transitionFunc = phoneTransitionPrevious
                    if (i == rangeLen-1):
                        if (msg['leftSide']):
                            transitionFunc = phoneTransitionAppearLeftFromBottom
                        else:
                            transitionFunc = phoneTransitionAppearRightFromBottom
                    else:
                        transitionFunc = phoneTransitionPrevious
                else:
                    if (i == rangeLen-1):
                        if (msg['leftSide']):
                            transitionFunc = phoneTransitionAppearLeft
                        else:
                            transitionFunc = phoneTransitionAppearRight
                    else:
                        transitionFunc = phoneTransitionNone


        if ('special' in msg) and (msg['special']):
            if ('phoneType' in msg):
                renpy.show(var_special_msg_image_names_phone[msg['phoneType']], at_list=[transitionFunc(var_msg_ypos_phone[i])], tag=imgName, zorder=6)
                renpy.with_statement(None)
            else:
                renpy.show(var_special_msg_image_names_phone[0], at_list=[transitionFunc(var_msg_ypos_phone[i])], tag=imgName, zorder=6)
                renpy.with_statement(None)
        else:
            if (msg['leftSide']):
                renpy.show(var_recv_msg_length_image_names_phone[msg['length']][msg['option']], at_list=[transitionFunc(var_msg_ypos_phone[i])], tag=imgName, zorder=6)
                renpy.with_statement(None)
            else:
                renpy.show(var_sent_msg_length_image_names_phone[msg['length']][msg['option']], at_list=[transitionFunc(var_msg_ypos_phone[i])], tag=imgName, zorder=6)
                renpy.with_statement(None)

    def drawMessagesPhone(force_no_transition=False):
        global var_msg_positions_phone
        global var_message_queue
        global var_recv_msg_length_images_phone
        global var_sent_msg_length_images_phone

        currentQueue = var_message_queue[var_current_dialog]

        queueLen = len(currentQueue)

        messengerMaxLen = len(var_msg_positions_phone)

        rangeLen = min(queueLen, messengerMaxLen)

        for i in range(messengerMaxLen):
            imgName = "screen_msg_pos" + str(i)
            renpy.hide(imgName)

        for i in range(rangeLen):
            msg = currentQueue[i + (queueLen - rangeLen)]
            imgName = "screen_msg_pos" + str(i)
            drawSingleMessagePhone(i, rangeLen, queueLen, msg, force_no_transition)

    def drawMessages(force_no_transition=False):
        if var_messenger_is_phone:
            drawMessagesPhone(force_no_transition)
        else:
            drawMessagesDesktop(force_no_transition)
